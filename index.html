<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>찬란한 6월의 선물 랜덤 상자 시뮬레이터</title>
  <style>
    /* 기본 스타일 */
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; color: #000; }
    .container { width: 100%; max-width: 600px; margin: 20px; padding: 20px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h1 { text-align: center; font-size: 1.5rem; margin-bottom: 1rem; font-weight: bold; }
    .controls { display: flex; gap: 5px; align-items: center; margin-bottom: 1rem; }
    .controls button { flex: 1; padding: 0.5rem; font-size: 1rem; font-weight: bold; border: 1px solid #ccc; border-radius: 4px; background: #eee; cursor: pointer; }
    .controls button:hover { background: #ddd; }
    .controls input { width: 100px; padding: 0.5rem; font-size: 1rem; text-align: center; border: 1px solid #ccc; border-radius: 4px; }
    button#runBtn { width: 100%; padding: 0.75rem; font-size: 1rem; background-color: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    button#runBtn:hover { background-color: #0056b3; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ddd; padding: 0.5rem; text-align: center; font-weight: bold; }
    th { background-color: #f2f2f2; }
    /* 희소도별 텍스트 색상 */
    .rarity-purple { color: #800080; }
    .rarity-gold   { color: #FFD700; }
    .rarity-yellow { color: #CCCC00; }
    .rarity-blue   { color: #0000FF; }
    .rarity-green  { color: #008000; }
    .rarity-grey   { color: #808080; }
    /* 다크 모드 */
    @media (prefers-color-scheme: dark) {
      body { background-color: #121212; color: #e0e0e0; }
      .container { background: #1e1e1e; box-shadow: 0 2px 8px rgba(0,0,0,0.5); }
      th { background-color: #2c2c2c; }
      td, th { border-color: #333; }
      .controls button, .controls input { background: #2c2c2c; color: #e0e0e0; border: 1px solid #555; }
      .controls button:hover { background: #3a3a3a; }
    }
    @media (max-width: 480px) { h1 { font-size: 1.25rem; } button#runBtn, .controls button, .controls input { font-size: 0.9rem; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>찬란한 6월의 선물 랜덤 상자 시뮬레이터</h1>
    <div class="controls">
      <button data-delta="-100">-100</button>
      <button data-delta="-10">-10</button>
      <input type="number" id="trials" min="1" value="1000">
      <button data-delta="10">+10</button>
      <button data-delta="100">+100</button>
    </div>
    <button id="runBtn">실행</button>
    <div id="results"></div>
  </div>

  <script>
    // 희소도 등급 매핑 함수
    function getRarity(rate) {
      if (rate <= 0.01) return { name: 'purple', rank: 6 };
      if (rate <= 0.1)  return { name: 'gold',   rank: 5 };
      if (rate <= 1)    return { name: 'yellow', rank: 4 };
      if (rate <= 3)    return { name: 'blue',   rank: 3 };
      if (rate <= 10)   return { name: 'green',  rank: 2 };
      return { name: 'grey', rank: 1 };
    }

    // 확률표 정의
    const items = [
      { name: '염원의 정기 1개',     rate: 0.0030 },
      { name: '고결한 이지의 방어구 선택 상자 1개', rate: 0.0100 },
      { name: '하르키니의 강화 주문서 선택 상자 1개', rate: 0.0200 },
      { name: '에아나드의 잉크 (전설) 1개', rate: 0.0900 },
      { name: '전설 장비 선택 상자 1개', rate: 0.1000 },
      { name: '영웅 무기 환영 소환권 (1회) (귀속) 1개', rate: 0.3000 },
      { name: '전설 소환권 선택 상자 (귀속) 1개', rate: 0.1000 },
      { name: '전설 위상의 파편 (귀속) 1개', rate: 0.5500 },
      { name: '영웅 위상의 파편 (귀속) 1개', rate: 3.0000 },
      { name: '호라의 마법부여석 선택 상자 (귀속) 1개', rate: 1.0000 },
      { name: '아스티의 특별 소환권 (11회) 선택 상자 (귀속) 1개', rate: 3.5000 },
      { name: '찬란한 소환권 (11회) 선택 상자 (귀속) 2개', rate: 18.0000 },
      { name: '희귀 정원의 잎새 (귀속) 1개', rate: 4.5000 },
      { name: '영웅 정원의 잎새 (귀속) 1개', rate: 1.5000 },
      { name: '별의 조각 (귀속) 10개', rate: 8.5000 },
      { name: '그릇된 자의 잔재 (귀속) 300개', rate: 15.0000 },
      { name: '기록자의 인장 (귀속) 5,000개', rate: 0.0050 },
      { name: '기록자의 인장 (귀속) 300개', rate: 0.5000 },
      { name: '기록자의 인장 (귀속) 100개', rate: 3.0000 },
      { name: '기록자의 인장 (귀속) 50개', rate: 13.0000 },
      { name: '눈부신 무기 환영 소환권 (11회) (귀속) 100개', rate: 0.0100 },
      { name: '눈부신 무기 환영 소환권 (11회) (귀속) 5개', rate: 1.0000 },
      { name: '눈부신 무기 환영 소환권 (11회) (귀속) 1개', rate: 26.3120 }
    ];

    // 누적 확률 계산
    let cum = 0;
    const cumulative = items.map(item => {
      cum += item.rate;
      const rarity = getRarity(item.rate);
      return { ...item, threshold: cum/100, rarity };
    });

    // 수량 조절 버튼 이벤트
    document.querySelectorAll('.controls button').forEach(btn => {
      btn.addEventListener('click', () => {
        const delta = parseInt(btn.getAttribute('data-delta'));
        const input = document.getElementById('trials');
        let val = Math.max(1, parseInt(input.value) + delta);
        input.value = val;
      });
    });

    document.getElementById('runBtn').addEventListener('click', () => {
      const trials = parseInt(document.getElementById('trials').value, 10);
      if (isNaN(trials) || trials <= 0) return;

      // 카운트 초기화
      const counts = cumulative.map(item => ({ ...item, count: 0 }));

      // 시뮬
      for (let i = 0; i < trials; i++) {
        const r = Math.random();
        for (let it of counts) {
          if (r <= it.threshold) { it.count++; break; }
        }
      }

      // 정렬: 등장 횟수 없는 아이템 하단, 그 외 희소도 순
      counts.sort((a,b) => {
        if ((a.count>0)!=(b.count>0)) return (b.count>0?1:0) - (a.count>0?1:0);
        if (a.count>0) return b.rarity.rank - a.rarity.rank;
        return a.rarity.rank - b.rarity.rank;
      });

      // 테이블 출력
      let html = '<table><thead><tr><th>아이템</th><th>개수</th><th>비율</th></tr></thead><tbody>';
      counts.forEach(item => {
        const ratio = ((item.count/trials)*100).toFixed(4) + '%';
        html += `<tr><td class="rarity-${item.rarity.name}">${item.name}</td><td>${item.count}</td><td>${ratio}</td></tr>`;
      });
      html += '</tbody></table>';
      document.getElementById('results').innerHTML = html;
    });
  </script>
</body>
</html>
